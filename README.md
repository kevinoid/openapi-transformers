OpenAPI Transformers
====================

[![Build Status](https://img.shields.io/github/actions/workflow/status/kevinoid/openapi-transformers/node.js.yml?branch=main&style=flat&label=build)](https://github.com/kevinoid/openapi-transformers/actions?query=branch%3Amain)
[![Coverage](https://img.shields.io/codecov/c/github/kevinoid/openapi-transformers/main.svg?style=flat)](https://app.codecov.io/gh/kevinoid/openapi-transformers/branch/main)
[![Dependency Status](https://img.shields.io/librariesio/release/npm/@kevinoid/openapi-transformers.svg?style=flat)](https://libraries.io/npm/@kevinoid%2Fopenapi-transformers)
[![Supported Node Version](https://img.shields.io/node/v/@kevinoid/openapi-transformers.svg?style=flat)](https://www.npmjs.com/package/@kevinoid/openapi-transformers)
[![Version on NPM](https://img.shields.io/npm/v/@kevinoid/openapi-transformers.svg?style=flat)](https://www.npmjs.com/package/@kevinoid/openapi-transformers)

A collection of classes for transforming
[OpenAPI](https://github.com/OAI/OpenAPI-Specification/) documents,
particularly for compatibility with code generators like
[Autorest](https://github.com/Azure/autorest) and [OpenAPI
Generator](https://openapi-generator.tech/).


## Introductory Example

To rename all Schema Objects defined in `components` of an OpenAPI document:

```js
import RenameComponentsTransformer from '@kevinoid/openapi-transformers';
import openapi from './openapi.json' with { type: 'json' };

function renameSchema(schemaName) {
    return `New${schemaName}`;
}

const transformer = new RenameComponentsTransformer({ schemas: renameSchema });
console.log(transformer.transformOpenApi(openapi));
```


## Example with [`@kevinoid/openapi-transformer-cli`](https://github.com/kevinoid/openapi-transformer-cli)

To remove `headers` from responses in an OpenAPI document:

```sh
openapi-transformer -t @kevinoid/openapi-transformers/remove-response-headers.js <openapi-old.json >openapi-new.json
```


## Transformers

| **Transformer**                                                                                      | **Description** |
| ---------------------------------------------------------------------------------------------------- | --------------- |
| [AddTagToOperationIdsTransformer](add-tag-to-operation-ids.js)                                       | Prefix `operationId` with the first tag name and an underscore. |
| [AddXMsEnumNameTransformer](add-x-ms-enum-name.js)                                                   | Add `x-ms-enum.name` from schema name, if not present. |
| [AddXMsEnumValueNamesTransformer](add-x-ms-enum-value-names.js)                                      | Add `x-ms-enum.values.name` to enums where the name generated by Autorest differs from the Microsoft C# Capitalization Rules for Identifiers. |
| [AdditionalPropertiesToObjectTransformer](additional-properties-to-object.js)                        | Replace boolean `additionalProperties` with a Schema. |
| [AdditionalPropertiesToUnconstrainedTransformer](additional-properties-to-unconstrained.js)          | Replace `additionalProperties` (and `patternProperties`) with an unconstrained schema alongside other properties. |
| [AnyOfNullToNullableTransformer](any-of-null-to-nullable.js)                                         | Replace `type: 'null'` in `anyOf` with `nullable: true` (for OAS 3.0). |
| [BinaryStringToFileTransformer](binary-string-to-file.js)                                            | Replace `type: string` with `format: binary` (or `format: file`) with `type: file`. |
| [BoolEnumToBoolTransformer](bool-enum-to-bool.js)                                                    | Replace `enum: [true, false]` with `type: boolean`. |
| [ClearHtmlResponseSchemaTransformer](clear-html-response-schema.js)                                  | Remove response content for the `text/html` media type. |
| [ClientParamsToGlobalTransformer](client-params-to-global.js)                                        | Move parameters with `x-ms-parameter-location: client` defined on Path Item Objects and Operation Objects to the Components or Definitions Object. |
| [ConstToEnumTransformer](const-to-enum.js)                                                           | Convert Schema Objects with `const` to `enum`. |
| [AssertPropertiesTransformer](assert-properties.js)                                                  | Throw an `Error` when given properties are present. |
| [EscapeEnumValuesTransformer](escape-enum-values.js)                                                 | Escape string enum values appropriately for C# string literals. |
| [ExclusiveMinMaxToBoolTransformer](exclusive-min-max-to-bool.js)                                     | Convert Schema Objects with numeric values for `exclusiveMaximum` and/or `exclusiveMinimum` to boolean values with corresponding `maximum` and/or `minimum`. |
| [FormatToTypeTransformer](format-to-type.js)                                                         | Convert known formats in an OAS3 doc to types. |
| [InlineNonObjectSchemaTransformer](inline-non-object-schemas.js)                                     | Inline schemas with non-object type. |
| [MergeAllOfTransformer](merge-all-of.js)                                                             | Merge `allOf` schemas into the parent schema. |
| [MergeAnyOfTransformer](merge-any-of.js)                                                             | Merge `anyOf` schemas into the parent schema. |
| [MergeOneOfTransformer](merge-one-of.js)                                                             | Merge `oneOf` schemas into the parent schema. |
| [NullableNotRequiredTransformer](nullable-not-required.js)                                           | Make properties which are `nullable` non-`required`. |
| [NullableToTypeNullTransformer](nullable-to-type-null.js)                                            | Add `'null'` to `type` of Schema Objects with `nullable: true` or `x-nullable: true`. |
| [OpenApi31To30Transformer](openapi31to30.js)                                                         | Convert an OpenAPI 3.1.* document to OpenAPI 3.0.3. |
| [PathParametersToOperationTransformer](path-parameters-to-operations.js)                             | Move parameters defined on Path Item Objects to the beginning of the parameters array of the Operation Objects. |
| [PatternPropertiesToAdditionalPropertiesTransformer](pattern-properties-to-additional-properties.js) | Combine any `patternProperties` into `additionalProperties`. |
| [QueriesToXMsPathsTransformer](queries-to-x-ms-paths.js)                                             | Move paths with query parameters from `paths` to `x-ms-paths`. |
| [ReadOnlyNotRequiredTransformer](read-only-not-required.js)                                          | Ensure `readOnly` schema properties are not `required`. |
| [RefPathParametersTransformer](ref-path-parameters.js)                                               | Move Parameters defined on Path Item Objects to global parameters which are referenced in the Path Item. |
| [RemoveDefaultOnlyResponseProducesTransformer](remove-default-only-response-produces.js)             | Remove `produces` from Operations with only a default response. |
| [RemovePathsWithServersTransformer](remove-paths-with-servers.js)                                    | Remove Path Item Objects which have `servers`. |
| [RemoveQueryFromPathsTransformer](remove-query-from-paths.js)                                        | Remove query component of path in Paths Object. |
| [RemoveRefSiblingsTransformer](remove-ref-siblings.js)                                               | Remove properties from Reference Objects. |
| [RemoveRequestBodyTransformer](remove-request-body.js)                                               | Remove `requestBody` from operations on a given set of HTTP methods. |
| [RemoveResponseHeadersTransformer](remove-response-headers.js)                                       | Remove `headers` from Response objects.
| [RemoveSecuritySchemeIfTransformer](remove-security-scheme-if.js)                                    | Remove `security` schemes matching a given predicate. |
| [RemoveTypeIfTransformer](remove-type-if.js)                                                         | Remove `type` from Schema Objects where `type` matches a given predicate. |
| [RenameComponentsTransformer](rename-components.js)                                                  | Rename `components`. |
| [ReplacedByToDescriptionTransformer](replaced-by-to-description.js)                                  | Convert `x-deprecated.replaced-by` to `x-deprecated.description`, if not present. |
| [ServerVarsToPathParamsTransformer](server-vars-to-path-params.js)                                   | Convert Server Variables in path portion to Parameters on Path Item Objects. |
| [ServerVarsToParamHostTransformer](server-vars-to-x-ms-parameterized-host.js)                        | Convert Server Variables in host portion to `x-ms-parameterized-host`. |
| [TypeNullToEnumTransformer](type-null-to-enum.js)                                                    | Convert Schema Objects with `type: 'null'` to `enum: [null]`. |
| [TypeNullToNullableTransformer](type-null-to-nullable.js)                                            | Convert Schema Objects with `'null'` in `type` to `nullable: true`. |
| [UrlencodedToStringTransformer](urlencoded-to-string.js)                                             | Change request parameter types to string for operations which only consume `application/x-www-form-urlencoded`. |
| [XEnumToXMsEnumTransformer](x-enum-to-ms.js)                                                         | Convert `x-enum-descriptions` and `x-enum-varnames` to `x-ms-enum`. |


## Installation

[This package](https://www.npmjs.com/package/@kevinoid/openapi-transformers) can be
installed using [npm](https://www.npmjs.com/), either globally or locally, by
running:

```sh
npm install @kevinoid/openapi-transformers
```


## Recipes

More examples can be found in the [test
specifications](https://kevinoid.github.io/openapi-transformers/spec).


## API Docs

To use this module as a library, see the [API
Documentation](https://kevinoid.github.io/openapi-transformers/api).


## Contributing

Contributions are appreciated.  Contributors agree to abide by the [Contributor
Covenant Code of
Conduct](https://www.contributor-covenant.org/version/1/4/code-of-conduct.html).
If this is your first time contributing to a Free and Open Source Software
project, consider reading [How to Contribute to Open
Source](https://opensource.guide/how-to-contribute/)
in the Open Source Guides.

If the desired change is large, complex, backwards-incompatible, can have
significantly differing implementations, or may not be in scope for this
project, opening an issue before writing the code can avoid frustration and
save a lot of time and effort.


## License

This project is available under the terms of the [MIT License](LICENSE.txt).
See the [summary at TLDRLegal](https://tldrlegal.com/license/mit-license).
